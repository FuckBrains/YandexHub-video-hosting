{% extends "main.html" %}
{% block content %}
{% load poll_extras %}
<main role="main" style="margin-top: 0px !important;">
    {% include "components/channel/header.html" %}
    <div style="position: relative; height: 140px; width: 100%;">
        <div style="width: 45%; position: relative; margin-left: auto; margin-right: auto;"
            class="user-video-block row row-cols-5" data-masonry='{"percentPosition": true }'>
            <div style="margin-top: 35px; width: 100%;">
                <div>
                    <div class="col-md-10" style="margin-left: auto; margin-right: auto; top: 0;">

                        {% if channel == request.user %}
                        <div class="card shadow-sm"
                            style="margin-left: auto; margin-right: auto; width: 85%; border: 1px solid rgba(0,0,0,.125); padding: 15px; height: auto; margin-bottom: 25px;">
                            <div style="margin-top: 10px;">
                                <h4 style="text-align: center;">The community tab was created so that the channel author
                                    can share news or any other information with his audience. ğŸ‘½</h4>
                            </div>
                            <div style="margin-top: 15px; margin-left: auto; margin-right: auto; padding-bottom: 5px;">
                                <a class="btn btn-primary" style="cursor: pointer;"
                                    onclick="transition_link(`{% url 'create__article__page' %}`)">Create article</a>
                            </div>
                        </div>
                        {% endif %}

                        {% for article in articles %}
                        <div class="card shadow-sm"
                            style="margin-left: auto; margin-right: auto; width: 85%; border: 1px solid rgba(0,0,0,.125); padding: 15px; height: auto; margin-bottom: 25px;">
                            <div>
                                <div class="img"
                                    style="width: 42px; display: inline-block; height: 42px; border-radius: 50%; background-image: url({{ article.creator.avatar.url }});">
                                </div>
                                <div
                                    style="margin-left: 10px; display: inline-block; position: absolute; margin-top: 11px;">
                                    <b style="font-weight: 600 !important;">{{ article.creator.username }}</b> Â· {{ article.date_created|date_func }}</div>
                            </div>
                            <div style="margin-top: 10px;">
                                {{ article.text|safe }}
                            </div>
                            <div style="margin-top: 15px;">
                                <!-- Likes -->
                                {% if article.article_id|check_article_like:request.user.user_id %}
                                <button class="btn btn-reaction-active" id="like_article_{{article.article_id}}"
                                    onclick="like_article('{{article.article_id}}');">{{ article.likes|brief_likes_format }} ğŸ‘</button>
                                {% else %}
                                <button class="btn btn-reaction" id="like_article_{{article.article_id}}"
                                    onclick="like_article('{{article.article_id}}');">{{ article.likes|brief_likes_format }} ğŸ‘</button>
                                {% endif %}

                                <!-- Dislikes -->
                                {% if article.article_id|check_article_dislike:request.user.user_id %}
                                <button class="btn btn-reaction-active" id="dislike_article_{{article.article_id}}" onclick="dislike_article('{{article.article_id}}');">{{ article.dislikes|brief_likes_format }} ğŸ‘</button>      
                                {% else %}
                                <button class="btn btn-reaction" id="dislike_article_{{article.article_id}}" onclick="dislike_article('{{article.article_id}}');">{{ article.dislikes|brief_likes_format }} ğŸ‘</button>
                                {% endif %}

                                {% if request.user == article.creator %}
                                <a class="btn btn-reaction-active" style="cursor: pointer;"
                                    onclick="transition_link(`{% url 'edit__article__page' article.article_id %}`)">Change</a>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}